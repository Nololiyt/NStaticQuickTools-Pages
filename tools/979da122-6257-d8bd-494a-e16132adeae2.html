<!DOCTYPE html>

<head>
    <title>
        Base64 String - File Converter
    </title>
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?de7e8f54e867fffffa0bc48c0788f8bc";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</head>

<body>
    <h1>Welcome to NStaticQuickTools!</h1>
    <div>
        Here is a base64 string - file converter. The base64 strings should not contain the MIME type. This tool is based on <a href="https://github.com/dankogai/js-base64" target="_blank">js-base64</a>.
    </div>
    <div>
        <script src="./libs/base64.min.js"></script>
        <script>
            function toFile() {
                var base64String = document.getElementById("input1").value;
                var blob = new Blob([Base64.toUint8Array(base64String)], {
                    type: "application/octet-stream"
                });
                var url = URL.createObjectURL(blob);
                var a = document.createElement("a");
                a.setAttribute("href", url);
                a.setAttribute("download", "add its extension behind");
                a.setAttribute("target", "_blank");
                var clickEvent = document.createEvent("MouseEvents");
                clickEvent.initEvent("click", true, true);
                a.dispatchEvent(clickEvent);
            }

            function toBase64(obj) {
                var file = obj.files[0];
                var reader = new FileReader();
                reader.onload = function(ev) {
                    document.getElementById("input1").value =
                        Base64.fromUint8Array(new Uint8Array(ev.target.result));
                }
                reader.readAsArrayBuffer(file);
            }
        </script>

        <ul>
            <li>
                Base64 string to file: <input id="input1" type="text" />
                <button type="button" onclick="toFile()">To file.</button>
            </li>
            <li>
                File to base64 string: <input id="input2" type="file" onchange="toBase64(this)" />
            </li>
        </ul>

        <div id="output"></div>
    </div>
    <footer>
        <div>
            ====================================
        </div>
        <div>
            Now it's the footer! <a href="../index.html">Back to the index page.</a>
        </div>
    </footer>
</body>